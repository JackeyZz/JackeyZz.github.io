---
title: 企业软件开发_EJB3.0、性能调优、web服务器
date: 2018-05-15 19:35:05
tags: [企业软件开发]
categories: [课堂笔记]
---
## 企业软件系统概述
计算程序的基本组成:
- 表示层
- 业务逻辑层
- 数据访问层

大型互联网应用系统具有的特点：
- 高并发、大流量
- 高可用
- 海量数量
- 用户分布广泛、网络情况复杂
- 安全环境恶劣
- 需求快速变更，发布频繁

网站访问的二八定律：
- 80%的访问集中在20%的数据上
- 20%数据集中在内存缓存

## web服务器
- Microsoft IIS:仅支持window,用于.net
- Tomcat
  - 轻量级
  - 开源
  - 被使用最广泛
  - 主流jsp/servlet容器，但需要配合weblogic、Jboss等容器使用EJB
- Apache
  - 使用排名第一
  - 以进程为基础的结构
  - 与Tomcat的区别
    - Apache支持静态页，Tomcat支持动态的
    - Apache是一个web服务器环境程序，可作为web服务器使用，tomcat 是应用(java)服务器，是Apache的扩展，又独立于Apache
    - Apache侧重http server，Tomcat侧重servlet引擎
- Lighttpd
  - 德国的
  - OpenSource轻量级
  - 单线程，针对大量持续连接
- Nginx
  - 俄罗斯的
  - 以事件驱动方式编写的
  - 反向代理、负载平web服务器、http反向代理和邮件代理服务器
  - 全球使用量第三
  - 特点：
    - 高并发连接
    - 内存消耗少
    - 配置文件非常简单
    - 成本低廉
- Tengine

## Websphere MQ
WebSphere MQ 为用户和应用开发人员提供了一种直接，简单，成熟的手段以实现应用系统在不同操作系统平台之间稳定可靠地传递，交换重要的数据和信息，确保消息不丢失/不复传。

MQ的传输协议是TCP，以安全性为主，支持文件，不支持文件目录的传输。
MQ的连接机制是通道、队列，传输方式是消息(消息描述符+用户数据)

消息分为
- 请求消息
- 回复消息
- 报文消息
- 报告消息

死信队列是存储无法发送到其正确目的地的消息的队列。

WebSphere MQ是唯一可保证信息一次性传输的中间件,确保对消息一次仅且一次(once-and-only-once)的传递，做到不丢失、不重传、次序不乱。

触发应用程序是指MQ能够在触发条件满足时，唤醒应用程序的执行，即应用程序不必总是在运行中的。
触发的对象：
- 应用程序
- 通道

## EJB3.0
相比EJB2.0：
- 使用java元数据注释
- 简化访问EJB环境的API
- 不需要home接口、对象接口以及组件接口
- 提供另外两种获取资源的方式
  - 在EJB2.0:通过InitialContext的lookup方法来获取资源;
  - 在EJB3.0:通过EJBContext的lookup方法;
  - 通过依赖注入方式;
- 消除了持久实体需要的所有接口

## EJB性能优化
### 无状态会话bean调优
- 调整实例池大小
- 设置实例池空闲延时
- 有效缓存资源

### 有状态会话bean调优
- 调整缓存大小
- 有效控制序列化

### 实体bean调优
- 使用CMP 2.x或JPA。
- 提供本地接口；
- 对实例池大小进行调整；
- 调整缓存大小；
- 选择合适的事务语义和事务隔离级别；
- 在获得大量数据时，建议使用JDBC；
- 在BMP中优化JDBC操作；
- 选择合适的RDBMS驱动；
- 批量更新或获取。

### MDB调优
- 调整实例池大小
- JMS相关调整

### web服务器调优
- 如果Web应用是无状态的，则关闭HTTP会话支持这一特性。<%page session=“false”%>
- 不要在session中存储大量的对象，及时释放会话。
- 针对不同HTTP keek-alive设置，设置相应的优化值。
- 将JSP重新编译选项关闭；
- 使用Web服务提供的JSP、Servlet缓存技术；
- 不要使用Servlet规范已经丢弃的单线程模型。
